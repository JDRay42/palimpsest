@using Palimpsest.Domain.Enums
@model IEnumerable<QuestionableItem>

@{
    ViewData["Title"] = "Questionable Items";
}

<h2 style="margin-bottom: 30px;">Questionable Items</h2>

<sl-alert variant="primary" open style="margin-bottom: 20px;">
    <sl-icon slot="icon" name="info-circle"></sl-icon>
    <strong>About Questionable Items</strong>
    <p style="margin: 10px 0 0 0;">
        This page displays conflicts, contradictions, ambiguities, and other items that require human review.
    </p>
</sl-alert>

@if (!Model.Any())
{
    <sl-card style="margin: 40px 0;">
        <div style="text-align: center; padding: 40px;">
            <sl-icon name="question-circle" style="font-size: 64px; color: #667eea; margin-bottom: 20px;"></sl-icon>
            <h3>No Questionable Items</h3>
            <p>Great! No conflicts or issues have been detected in your universe.</p>
        </div>
    </sl-card>
}
else
{
    <div style="margin-bottom: 20px;">
        <sl-button-group>
            <sl-button variant="@(ViewBag.Filter == null ? "primary" : "default")" href="/questionable">
                All (@Model.Count())
            </sl-button>
            <sl-button variant="@(ViewBag.Filter == "Conflict" ? "primary" : "default")" href="/questionable?filter=Conflict">
                Conflicts
            </sl-button>
            <sl-button variant="@(ViewBag.Filter == "Ambiguity" ? "primary" : "default")" href="/questionable?filter=Ambiguity">
                Ambiguities
            </sl-button>
            <sl-button variant="@(ViewBag.Filter == "Inconsistency" ? "primary" : "default")" href="/questionable?filter=Inconsistency">
                Inconsistencies
            </sl-button>
        </sl-button-group>
    </div>

    <div style="display: flex; flex-direction: column; gap: 15px;">
        @foreach (var item in Model)
        {
            <sl-card>
                <div slot="header" style="display: flex; justify-content: space-between; align-items: center;">
                    <strong>@item.ItemType</strong>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <sl-badge variant="@(item.Severity switch {
                            Severity.Error => "danger",
                            Severity.Warn => "warning",
                            Severity.Info => "primary",
                            _ => "neutral"
                        })" pill>
                            @item.Severity
                        </sl-badge>
                        <sl-badge variant="@(item.Status switch {
                            QuestionableItemStatus.Open => "primary",
                            QuestionableItemStatus.Dismissed => "neutral",
                            QuestionableItemStatus.Resolved => "success",
                            _ => "neutral"
                        })">
                            @item.Status
                        </sl-badge>
                    </div>
                </div>
                
                <p style="margin: 15px 0;">@item.ItemType - @item.Severity</p>
                
                <p style="margin: 10px 0; padding: 10px; background: #f5f5f5; border-radius: 5px;">
                    <small>@item.Details</small>
                </p>
                
                <div slot="footer" style="display: flex; justify-content: space-between; align-items: center;">
                    <small style="color: #666;">
                        Detected: @item.CreatedAt.ToString("MMM d, yyyy")
                    </small>
                    <div style="display: flex; gap: 10px;">
                        <sl-button size="small" variant="primary" outline>
                            Review
                        </sl-button>
                        <sl-button size="small" variant="default" outline>
                            Dismiss
                        </sl-button>
                    </div>
                </div>
            </sl-card>
        }
    </div>
}

<div style="margin-top: 30px;">
    <sl-button href="/universes" variant="default">
        <sl-icon slot="prefix" name="arrow-left"></sl-icon>
        Back to Universes
    </sl-button>
</div>
