@model Universe

@{
    ViewData["Title"] = "Create Universe";
}

<h2>Create Universe</h2>

<sl-card style="max-width: 600px; margin: 20px 0;">
    <form asp-action="Create" method="post" id="universeForm">
        @Html.AntiForgeryToken()
        
        <!-- Hidden inputs for form submission -->
        <input type="hidden" id="hiddenName" name="Name" />
        <input type="hidden" id="hiddenAuthorName" name="AuthorName" />
        <input type="hidden" id="hiddenDescription" name="Description" />
        
        <div style="margin-bottom: 20px;">
            <label for="name">
                <strong>Universe Name</strong>
                <span style="color: red;">*</span>
            </label>
            <sl-input 
                id="name" 
                placeholder="e.g., The Evermore Saga" 
                required 
                style="margin-top: 5px;">
            </sl-input>
            <span asp-validation-for="Name" style="color: red; font-size: 14px;"></span>
        </div>
        
        <div style="margin-bottom: 20px;">
            <label for="authorName">
                <strong>Author Name</strong>
            </label>
            <sl-input 
                id="authorName" 
                placeholder="Your name or pseudonym"
                style="margin-top: 5px;">
            </sl-input>
        </div>
        
        <div style="margin-bottom: 20px;">
            <label for="description">
                <strong>Description</strong>
            </label>
            <sl-textarea 
                id="description" 
                placeholder="A brief description of your fictional universe..."
                rows="4"
                style="margin-top: 5px;">
            </sl-textarea>
        </div>
        
        <div style="display: flex; gap: 10px; margin-top: 30px;">
            <sl-button type="submit" variant="primary" id="submitBtn">
                <sl-icon slot="prefix" name="plus-circle"></sl-icon>
                Create Universe
            </sl-button>
            <sl-button href="/universes" variant="default">
                Cancel
            </sl-button>
        </div>
    </form>
</sl-card>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const form = document.getElementById('universeForm');
            const submitBtn = document.getElementById('submitBtn');
            
            // Wait for Shoelace components to be defined
            await Promise.all([
                customElements.whenDefined('sl-input'),
                customElements.whenDefined('sl-textarea'),
                customElements.whenDefined('sl-button')
            ]);
            
            console.log('Shoelace components loaded');
            
            // Intercept form submission and copy values from Shoelace components to hidden inputs
            submitBtn.addEventListener('click', (e) => {
                e.preventDefault();
                
                // Copy values from Shoelace components to hidden inputs
                const name = document.getElementById('name');
                const authorName = document.getElementById('authorName');
                const description = document.getElementById('description');
                
                document.getElementById('hiddenName').value = name.value || '';
                document.getElementById('hiddenAuthorName').value = authorName.value || '';
                document.getElementById('hiddenDescription').value = description.value || '';
                
                console.log('Form values:', {
                    name: name.value,
                    authorName: authorName.value,
                    description: description.value
                });
                
                // Submit the form
                form.submit();
            });
        });
    </script>
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
